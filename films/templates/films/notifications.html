{% extends 'films/base.html' %}
{% load films_tags %}

{% block content %}
  <h1>Подписка на уведомления</h1>
  <p>Выберите предпочтения для уведомлений и укажите вашу почту:</p>

  <form method="post" action="{% url 'films:notifications' %}">
    {% csrf_token %}

    <fieldset>
      <legend class="form-label">Частота уведомлений:</legend>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="frequency" id="instant" value="instant">
        <label class="form-check-label" for="instant">Как только произошли изменения</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="frequency" id="daily" value="daily">
        <label class="form-check-label" for="daily">Раз в день</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="frequency" id="weekly" value="weekly">
        <label class="form-check-label" for="weekly">Раз в неделю</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="frequency" id="monthly" value="monthly">
        <label class="form-check-label" for="monthly">Раз в месяц</label>
      </div>
    </fieldset>

    <fieldset>
      <legend class="form-label">Тип уведомлений:</legend>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="notification_type" id="add" value="add">
        <label class="form-check-label" for="add">Добавление нового фильма</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="notification_type" id="add_change" value="add_change">
        <label class="form-check-label" for="add_change">Добавление нового фильма или изменение имеющегося</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="notification_type" id="everything" value="everything">
        <label class="form-check-label" for="everything">Все изменения</label>
      </div>
    </fieldset>

    <div class="mb-3">
      <label for="email" class="form-label">Ваша почта:</label>
      <input type="email" class="form-control" id="email" name="email" required>
    </div>

    <button type="submit" class="btn btn-primary" id="savePreferences">Сохранить предпочтения</button>
    <div id="selectedPreferences" class="mt-3 d-none">
      <p>Выбранные настройки:</p>
      <p id="selectedFrequency"></p>
      <p id="selectedNotificationType"></p>
      <p id="userEmail"></p>
    </div>
  </form>

  <script>
    $(document).ready(function() {
      $('#savePreferences').click(function(event) {
        event.preventDefault(); // Prevent form submission

        // Get selected frequency
        var frequency = $('input[name=frequency]:checked').val();
        // Get selected notification type
        var notificationType = $('input[name=notification_type]:checked').val();
        // Get user email
        var userEmail = $('#email').val();

        // Set the text in the display div
        $('#selectedFrequency').text('Частота: ' + frequency);
        $('#selectedNotificationType').text('Тип уведомлений: ' + notificationType);
        $('#userEmail').text('Ваша почта: ' + userEmail);

        // Show the display div
        $('#selectedPreferences').removeClass('d-none');
      });
    });
  </script>
{% endblock %}
